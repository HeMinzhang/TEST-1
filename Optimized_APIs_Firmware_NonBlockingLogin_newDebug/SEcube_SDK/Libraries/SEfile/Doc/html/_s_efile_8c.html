<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>SEFile: /run/media/scaglia/5B106C33792E4440/polito/MAGISTRALE/current/tesi/SEfile_library/SEfile.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SEFile
   </div>
   <div id="projectbrief">Userspace drivers to manage a secure filesystem</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bc042b95c17dde01aa85ee6040333d86.html">SEfile_library</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">SEfile.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>In this file you will find the implementation of the public function already described in <a class="el" href="_s_efile_8h.html">SEfile.h</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_s_efile_8h_source.html">SEfile.h</a>&quot;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_s_e_f_i_l_e___h_a_n_d_l_e.html">SEFILE_HANDLE</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="struct_s_e_f_i_l_e___h_a_n_d_l_e.html" title="The SEFILE_HANDLE struct. ">SEFILE_HANDLE</a> struct.  <a href="struct_s_e_f_i_l_e___h_a_n_d_l_e.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_s_e_f_i_l_e___h_e_a_d_e_r.html">SEFILE_HEADER</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="struct_s_e_f_i_l_e___h_e_a_d_e_r.html" title="The SEFILE_HEADER struct. ">SEFILE_HEADER</a> struct.  <a href="struct_s_e_f_i_l_e___h_e_a_d_e_r.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_s_e_f_i_l_e___s_e_c_t_o_r.html">SEFILE_SECTOR</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="struct_s_e_f_i_l_e___s_e_c_t_o_r.html" title="The SEFILE_SECTOR struct This data struct is the actual sector organization. The total size should AL...">SEFILE_SECTOR</a> struct This data struct is the actual sector organization. The total size should ALWAYS be equal to <a class="el" href="group___sector___defines.html#gad205a758c315675de3ad9f5f1cbf962d">SEFILE_SECTOR_SIZE</a>. The first sector is used to hold ONLY the header. Thanks to the union data type, the developer can simply declare a sector and then choose if it is the header sector or not.  <a href="struct_s_e_f_i_l_e___s_e_c_t_o_r.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a369266c24eacffb87046522897a570d5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a369266c24eacffb87046522897a570d5"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>_GNU_SOURCE</b></td></tr>
<tr class="separator:a369266c24eacffb87046522897a570d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59d2e926963f89a7688333a5ee073c69"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a59d2e926963f89a7688333a5ee073c69"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SEFILE_NONCE_LEN</b>&#160;&#160;&#160;32</td></tr>
<tr class="separator:a59d2e926963f89a7688333a5ee073c69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7617f01b2063fc7205c6081b88801a75"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#a7617f01b2063fc7205c6081b88801a75">POS_TO_CIPHER_BLOCK</a>(current_position)&#160;&#160;&#160;((current_position / <a class="el" href="group___sector___defines.html#gad205a758c315675de3ad9f5f1cbf962d">SEFILE_SECTOR_SIZE</a>) - 1)*(<a class="el" href="group___sector___defines.html#ga6961ed45e472749b587136d18eb74b4d">SEFILE_SECTOR_DATA_SIZE</a> / <a class="el" href="group___sector___defines.html#ga9344350dc20df5bbdc5693775c54afcb">SEFILE_BLOCK_SIZE</a>)</td></tr>
<tr class="separator:a7617f01b2063fc7205c6081b88801a75"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a533853754430e7d85524fd5641a7bf3b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#a533853754430e7d85524fd5641a7bf3b">get_filename</a> (char *path, char *file_name)</td></tr>
<tr class="memdesc:a533853754430e7d85524fd5641a7bf3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function extract the filename pointed by path.  <a href="#a533853754430e7d85524fd5641a7bf3b">More...</a><br/></td></tr>
<tr class="separator:a533853754430e7d85524fd5641a7bf3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af387c94c97d3d3df73d0ddc6da891ad2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#af387c94c97d3d3df73d0ddc6da891ad2">get_path</a> (char *full_path, char *path)</td></tr>
<tr class="memdesc:af387c94c97d3d3df73d0ddc6da891ad2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function extract the path where the file is.  <a href="#af387c94c97d3d3df73d0ddc6da891ad2">More...</a><br/></td></tr>
<tr class="separator:af387c94c97d3d3df73d0ddc6da891ad2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99543075d3f99eca1a5ca4b2d5feb016"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#a99543075d3f99eca1a5ca4b2d5feb016">check_env</a> ()</td></tr>
<tr class="memdesc:a99543075d3f99eca1a5ca4b2d5feb016"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function check if the environmental variables are correctly initialized and set.  <a href="#a99543075d3f99eca1a5ca4b2d5feb016">More...</a><br/></td></tr>
<tr class="separator:a99543075d3f99eca1a5ca4b2d5feb016"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb97d3ccfe07f0f8b62c6f4c05b3d115"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#aeb97d3ccfe07f0f8b62c6f4c05b3d115">crypt_sectors</a> (void *buff_decrypt, void *buff_crypt, size_t datain_len, size_t current_offset, uint8_t *nonce_ctr, uint8_t *nonce_pbkdf2)</td></tr>
<tr class="memdesc:aeb97d3ccfe07f0f8b62c6f4c05b3d115"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function encrypts the buff_decrypt data by exploiting the functions provided by L1.h.  <a href="#aeb97d3ccfe07f0f8b62c6f4c05b3d115">More...</a><br/></td></tr>
<tr class="separator:aeb97d3ccfe07f0f8b62c6f4c05b3d115"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84651b6b79095cbb509ac22824595e4d"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#a84651b6b79095cbb509ac22824595e4d">crypt_header</a> (void *buff1, void *buff2, size_t datain_len, uint16_t direction)</td></tr>
<tr class="memdesc:a84651b6b79095cbb509ac22824595e4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function encrypts a header buffer by exploiting the functions provided by L1.h.  <a href="#a84651b6b79095cbb509ac22824595e4d">More...</a><br/></td></tr>
<tr class="separator:a84651b6b79095cbb509ac22824595e4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34d995f228e33aa28bff9af5cd8ca305"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#a34d995f228e33aa28bff9af5cd8ca305">decrypt_sectors</a> (void *buff_crypt, void *buff_decrypt, size_t datain_len, size_t current_offset, uint8_t *nonce_ctr, uint8_t *nonce_pbkdf2)</td></tr>
<tr class="memdesc:a34d995f228e33aa28bff9af5cd8ca305"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function decrypts the buff_crypt data by exploiting the functions provided by L1.h.  <a href="#a34d995f228e33aa28bff9af5cd8ca305">More...</a><br/></td></tr>
<tr class="separator:a34d995f228e33aa28bff9af5cd8ca305"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a558cc4a9929c6dc846d54ec42012466c"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#a558cc4a9929c6dc846d54ec42012466c">get_filesize</a> (<a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *hFile, uint32_t *length)</td></tr>
<tr class="memdesc:a558cc4a9929c6dc846d54ec42012466c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used to compute the total logic size of an open file handle.  <a href="#a558cc4a9929c6dc846d54ec42012466c">More...</a><br/></td></tr>
<tr class="separator:a558cc4a9929c6dc846d54ec42012466c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeda597741a9b6bf76b5258f6c996e678"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#aeda597741a9b6bf76b5258f6c996e678">decrypt_filename</a> (char *path, char *filename)</td></tr>
<tr class="memdesc:aeda597741a9b6bf76b5258f6c996e678"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used to compute the plaintext of a encrypted filename stored in path.  <a href="#aeda597741a9b6bf76b5258f6c996e678">More...</a><br/></td></tr>
<tr class="separator:aeda597741a9b6bf76b5258f6c996e678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ada7106da4eb0668715f317366777ef"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#a2ada7106da4eb0668715f317366777ef">decrypt_filehandle</a> (<a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *hFile, char *filename)</td></tr>
<tr class="memdesc:a2ada7106da4eb0668715f317366777ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used to compute the plaintext of a encrypted filename stored in an already open hFile header.  <a href="#a2ada7106da4eb0668715f317366777ef">More...</a><br/></td></tr>
<tr class="separator:a2ada7106da4eb0668715f317366777ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a700fedc67d30512447684ec1eff14bab"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#a700fedc67d30512447684ec1eff14bab">crypt_dirname</a> (char *dirpath, char *encDirname)</td></tr>
<tr class="memdesc:a700fedc67d30512447684ec1eff14bab"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used to compute the ciphertext of a directory name stored in dirname.  <a href="#a700fedc67d30512447684ec1eff14bab">More...</a><br/></td></tr>
<tr class="separator:a700fedc67d30512447684ec1eff14bab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac74803a54c2cb05ea329acdeef7f7856"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#ac74803a54c2cb05ea329acdeef7f7856">decrypt_dirname</a> (char *dirpath, char *decDirname)</td></tr>
<tr class="memdesc:ac74803a54c2cb05ea329acdeef7f7856"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used to compute the plaintext of a encrypted directory name stored in dirname.  <a href="#ac74803a54c2cb05ea329acdeef7f7856">More...</a><br/></td></tr>
<tr class="separator:ac74803a54c2cb05ea329acdeef7f7856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95ea3f63b783aca7223b6b885cab1a5e"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#a95ea3f63b783aca7223b6b885cab1a5e">valid_name</a> (char *name)</td></tr>
<tr class="memdesc:a95ea3f63b783aca7223b6b885cab1a5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks if the given name can be a valid encrypted filename/directory name.  <a href="#a95ea3f63b783aca7223b6b885cab1a5e">More...</a><br/></td></tr>
<tr class="separator:a95ea3f63b783aca7223b6b885cab1a5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a435a1cfd0cd619deb2efeb7aa3723126"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#a435a1cfd0cd619deb2efeb7aa3723126">secure_init</a> (se3_session *s, uint32_t keyID, uint16_t crypto)</td></tr>
<tr class="memdesc:a435a1cfd0cd619deb2efeb7aa3723126"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function creates a new secure environment, by allocating statically the parameters needed by the following functions.  <a href="#a435a1cfd0cd619deb2efeb7aa3723126">More...</a><br/></td></tr>
<tr class="separator:a435a1cfd0cd619deb2efeb7aa3723126"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8d0daae652fc1f3e2c29781591aa36e"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#ae8d0daae652fc1f3e2c29781591aa36e">secure_update</a> (se3_session *s, int32_t keyID, uint16_t crypto)</td></tr>
<tr class="memdesc:ae8d0daae652fc1f3e2c29781591aa36e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function can be called only after the <a class="el" href="_s_efile_8c.html#a435a1cfd0cd619deb2efeb7aa3723126" title="This function creates a new secure environment, by allocating statically the parameters needed by the...">secure_init()</a> function and give to the user the possibility to overwrite the Environment variables with new ones.  <a href="#ae8d0daae652fc1f3e2c29781591aa36e">More...</a><br/></td></tr>
<tr class="separator:ae8d0daae652fc1f3e2c29781591aa36e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71736a6b4cc1a0ec94d013052e1e2a10"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#a71736a6b4cc1a0ec94d013052e1e2a10">secure_finit</a> ()</td></tr>
<tr class="memdesc:a71736a6b4cc1a0ec94d013052e1e2a10"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function deallocate the structures defined by the <a class="el" href="_s_efile_8c.html#a435a1cfd0cd619deb2efeb7aa3723126" title="This function creates a new secure environment, by allocating statically the parameters needed by the...">secure_init()</a>. Should be called at the end of a session. No parameters are needed;.  <a href="#a71736a6b4cc1a0ec94d013052e1e2a10">More...</a><br/></td></tr>
<tr class="separator:a71736a6b4cc1a0ec94d013052e1e2a10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae99f8ccb396cbb5685d9e16bb3dbbe98"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#ae99f8ccb396cbb5685d9e16bb3dbbe98">secure_open</a> (char *path, <a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *hFile, int32_t mode, int32_t creation)</td></tr>
<tr class="memdesc:ae99f8ccb396cbb5685d9e16bb3dbbe98"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function opens a secure file and create a SEFILE_FHANDLE that can be used in future.  <a href="#ae99f8ccb396cbb5685d9e16bb3dbbe98">More...</a><br/></td></tr>
<tr class="separator:ae99f8ccb396cbb5685d9e16bb3dbbe98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbb72ef517bfb5e342fba86f2e72b25f"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#adbb72ef517bfb5e342fba86f2e72b25f">secure_create</a> (char *path, <a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *hFile, int mode)</td></tr>
<tr class="memdesc:adbb72ef517bfb5e342fba86f2e72b25f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function creates a new secure file and creates a SEFILE_FHANDLE that can be used in future. If the file already exists, it is overwritten with an empty one, all previous data are lost.  <a href="#adbb72ef517bfb5e342fba86f2e72b25f">More...</a><br/></td></tr>
<tr class="separator:adbb72ef517bfb5e342fba86f2e72b25f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb652f6362fd5635c4aaa8c5e67c7f1b"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#acb652f6362fd5635c4aaa8c5e67c7f1b">secure_write</a> (<a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *hFile, uint8_t *dataIn, uint32_t dataIn_len)</td></tr>
<tr class="memdesc:acb652f6362fd5635c4aaa8c5e67c7f1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function writes the characters given by dataIn to the encrypted file hFile. Before writing them, dataIn is encrypted according to the environmental parameters.  <a href="#acb652f6362fd5635c4aaa8c5e67c7f1b">More...</a><br/></td></tr>
<tr class="separator:acb652f6362fd5635c4aaa8c5e67c7f1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4468e0e71fe2626767388150952fbdf"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#ab4468e0e71fe2626767388150952fbdf">secure_read</a> (<a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *hFile, uint8_t *dataOut, uint32_t dataOut_len, uint32_t *bytesRead)</td></tr>
<tr class="memdesc:ab4468e0e71fe2626767388150952fbdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function reads from hFile bytesRead characters out of dataOut_len correctly decrypted ones and stores them in dataOut string.  <a href="#ab4468e0e71fe2626767388150952fbdf">More...</a><br/></td></tr>
<tr class="separator:ab4468e0e71fe2626767388150952fbdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a157807247b4913a73fc3b6677a61e6a3"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#a157807247b4913a73fc3b6677a61e6a3">secure_seek</a> (<a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *hFile, int32_t offset, int32_t *position, uint8_t whence)</td></tr>
<tr class="memdesc:a157807247b4913a73fc3b6677a61e6a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used to move correctly the file pointer.  <a href="#a157807247b4913a73fc3b6677a61e6a3">More...</a><br/></td></tr>
<tr class="separator:a157807247b4913a73fc3b6677a61e6a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae51272c2c3b72a01bd7aa98f25fb5245"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#ae51272c2c3b72a01bd7aa98f25fb5245">secure_truncate</a> (<a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *hFile, uint32_t size)</td></tr>
<tr class="memdesc:ae51272c2c3b72a01bd7aa98f25fb5245"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function resizes the file pointed by hFile to size. If size is bigger than its current size the gap is filled with 0s.  <a href="#ae51272c2c3b72a01bd7aa98f25fb5245">More...</a><br/></td></tr>
<tr class="separator:ae51272c2c3b72a01bd7aa98f25fb5245"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54f66c38e6025c8e57ceda5c43d51c5c"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#a54f66c38e6025c8e57ceda5c43d51c5c">secure_close</a> (<a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *hFile)</td></tr>
<tr class="memdesc:a54f66c38e6025c8e57ceda5c43d51c5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function releases resources related to hFile.  <a href="#a54f66c38e6025c8e57ceda5c43d51c5c">More...</a><br/></td></tr>
<tr class="separator:a54f66c38e6025c8e57ceda5c43d51c5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b2a9a6b81381a4ce20421831103b8b3"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#a6b2a9a6b81381a4ce20421831103b8b3">secure_ls</a> (char *path, char *list, uint32_t *list_length)</td></tr>
<tr class="memdesc:a6b2a9a6b81381a4ce20421831103b8b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function identifies which encrypted files and encrypted directories are present in the directory pointed by path and writes them in list. It only recognizes the ones encrypted with the current environmental parameters.  <a href="#a6b2a9a6b81381a4ce20421831103b8b3">More...</a><br/></td></tr>
<tr class="separator:a6b2a9a6b81381a4ce20421831103b8b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a987cae1899d44e2c86de985b6145d41b"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#a987cae1899d44e2c86de985b6145d41b">secure_getfilesize</a> (char *path, uint32_t *position)</td></tr>
<tr class="memdesc:a987cae1899d44e2c86de985b6145d41b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used to get the total logic size of an encrypted file pointed by path. Logic size will always be smaller than physical size.  <a href="#a987cae1899d44e2c86de985b6145d41b">More...</a><br/></td></tr>
<tr class="separator:a987cae1899d44e2c86de985b6145d41b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc10a53fb05941bb327447cbef30b963"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#afc10a53fb05941bb327447cbef30b963">secure_mkdir</a> (char *path)</td></tr>
<tr class="memdesc:afc10a53fb05941bb327447cbef30b963"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function creates a directory with an encrypted name.  <a href="#afc10a53fb05941bb327447cbef30b963">More...</a><br/></td></tr>
<tr class="separator:afc10a53fb05941bb327447cbef30b963"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab134ec0c74652e6c2ecac3096d0bfd7f"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#ab134ec0c74652e6c2ecac3096d0bfd7f">crypto_filename</a> (char *path, char *enc_name, uint16_t *encoded_length)</td></tr>
<tr class="memdesc:ab134ec0c74652e6c2ecac3096d0bfd7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the encrypted name of the file specified at position path and its length.  <a href="#ab134ec0c74652e6c2ecac3096d0bfd7f">More...</a><br/></td></tr>
<tr class="separator:ab134ec0c74652e6c2ecac3096d0bfd7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73a19f91c4b2838a6c1f126ac5e5381f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a73a19f91c4b2838a6c1f126ac5e5381f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>compute_blk_offset</b> (size_t current_offset, uint8_t *nonce)</td></tr>
<tr class="separator:a73a19f91c4b2838a6c1f126ac5e5381f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe0d197f2f2b834bfdd7e65f71695bff"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afe0d197f2f2b834bfdd7e65f71695bff"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>encrypt_name</b> (void *buff1, void *buff2, size_t size, uint16_t direction)</td></tr>
<tr class="separator:afe0d197f2f2b834bfdd7e65f71695bff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae977955a0ae4b48158806cd45d2cd12"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_efile_8c.html#aae977955a0ae4b48158806cd45d2cd12">secure_sync</a> (<a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *hFile)</td></tr>
<tr class="memdesc:aae977955a0ae4b48158806cd45d2cd12"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used in case we want to be sure that the physical file is synced with the OS buffers.  <a href="#aae977955a0ae4b48158806cd45d2cd12">More...</a><br/></td></tr>
<tr class="separator:aae977955a0ae4b48158806cd45d2cd12"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Environmental Variables</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>This static variables will store some data useful during the active session. </p>
</div></td></tr>
<tr class="memitem:gad3215e338581ce95b76b3b84b928d744"><td class="memItemLeft" align="right" valign="top">static se3_session *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___environmental_vars.html#gad3215e338581ce95b76b3b84b928d744">EnvSession</a> =NULL</td></tr>
<tr class="separator:gad3215e338581ce95b76b3b84b928d744"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7a8b4d6945f6a13f8683427dc7ab7a44"><td class="memItemLeft" align="right" valign="top">static int32_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___environmental_vars.html#ga7a8b4d6945f6a13f8683427dc7ab7a44">EnvKeyID</a> =NULL</td></tr>
<tr class="separator:ga7a8b4d6945f6a13f8683427dc7ab7a44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga328037c714e95e56186f9d5f0842adea"><td class="memItemLeft" align="right" valign="top">static uint16_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___environmental_vars.html#ga328037c714e95e56186f9d5f0842adea">EnvCrypto</a> =NULL</td></tr>
<tr class="separator:ga328037c714e95e56186f9d5f0842adea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>In this file you will find the implementation of the public function already described in <a class="el" href="_s_efile_8h.html">SEfile.h</a>. </p>
<dl class="section author"><dt>Authors</dt><dd>Francesco Giavatto, Nicolò Maunero, Giulio Scalia </dd></dl>
<dl class="section date"><dt>Date</dt><dd>17/09/2016 </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a7617f01b2063fc7205c6081b88801a75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define POS_TO_CIPHER_BLOCK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">current_position</td><td>)</td>
          <td>&#160;&#160;&#160;((current_position / <a class="el" href="group___sector___defines.html#gad205a758c315675de3ad9f5f1cbf962d">SEFILE_SECTOR_SIZE</a>) - 1)*(<a class="el" href="group___sector___defines.html#ga6961ed45e472749b587136d18eb74b4d">SEFILE_SECTOR_DATA_SIZE</a> / <a class="el" href="group___sector___defines.html#ga9344350dc20df5bbdc5693775c54afcb">SEFILE_BLOCK_SIZE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Macro used to convert the actual pointer position to the cipher blocks amount </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a99543075d3f99eca1a5ca4b2d5feb016"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t check_env </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function check if the environmental variables are correctly initialized and set. </p>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="a700fedc67d30512447684ec1eff14bab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t crypt_dirname </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dirpath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>encDirname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used to compute the ciphertext of a directory name stored in dirname. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dirpath</td><td>Path to the directory whose name has to be encrypted. No encrypted directory are allowed inside the path. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">encDirname</td><td>A preallocated string where to store the encrypted directory name </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="a84651b6b79095cbb509ac22824595e4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t crypt_header </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buff1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buff2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datain_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function encrypts a header buffer by exploiting the functions provided by L1.h. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buff1</td><td>Pointer to the header we want to encrypt/decrypt. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buff2</td><td>Pointer to an allocated header where to store the result. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">datain_len</td><td>How big is the amount of data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">direction</td><td>See SE3_DIR. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="aeb97d3ccfe07f0f8b62c6f4c05b3d115"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t crypt_sectors </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buff_decrypt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buff_crypt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datain_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>current_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>nonce_ctr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>nonce_pbkdf2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function encrypts the buff_decrypt data by exploiting the functions provided by L1.h. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buff_decrypt</td><td>The plaintext data to be encrypted </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buff_crypt</td><td>The preallocated buffer where to store the encrypted data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">datain_len</td><td>Specify how many data we want to encrypt. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_offset</td><td>Current position inside the file expressed as number of cipher blocks </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nonce_ctr</td><td>Initialization vector, see <a class="el" href="struct_s_e_f_i_l_e___h_e_a_d_e_r.html">SEFILE_HEADER</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nonce_pbkdf2</td><td>Initialization vector, see <a class="el" href="struct_s_e_f_i_l_e___h_e_a_d_e_r.html">SEFILE_HEADER</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="ab134ec0c74652e6c2ecac3096d0bfd7f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t crypto_filename </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>enc_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>encoded_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the encrypted name of the file specified at position path and its length. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>It can be absolute or relative but it can not be a directory. No encrypted directory are allowed inside the path. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">enc_name</td><td>Already allocate string where the encrypted filename should be stored. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">encoded_length</td><td>Pointer to an allocated uint16_t where the length of the encrypted filename is stored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="ac74803a54c2cb05ea329acdeef7f7856"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t decrypt_dirname </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dirpath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>decDirname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used to compute the plaintext of a encrypted directory name stored in dirname. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dirpath</td><td>Path to the directory whose name has to be decrypted. No encrypted directory are allowed inside the path. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">decDirname</td><td>A preallocated string where to store the decrypted directory name </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="a2ada7106da4eb0668715f317366777ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t decrypt_filehandle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *&#160;</td>
          <td class="paramname"><em>hFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used to compute the plaintext of a encrypted filename stored in an already open hFile header. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hFile</td><td>Already opened file handle to be read in order to obtain its plaintext filename. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">filename</td><td>A preallocated string where to store the plaintext filename. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="aeda597741a9b6bf76b5258f6c996e678"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t decrypt_filename </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used to compute the plaintext of a encrypted filename stored in path. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>Where the encrypted file is stored, it can be an absolute or relative path. No encrypted directory are allowed inside the path. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">filename</td><td>A preallocated string where to store the plaintext filename </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="a34d995f228e33aa28bff9af5cd8ca305"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t decrypt_sectors </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buff_crypt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buff_decrypt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datain_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>current_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>nonce_ctr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>nonce_pbkdf2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function decrypts the buff_crypt data by exploiting the functions provided by L1.h. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buff_crypt</td><td>The cipher text data to be decrypted </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buff_decrypt</td><td>The preallocated buffer where to store the decrypted data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">datain_len</td><td>Specify how many data we want to decrypt. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current_offset</td><td>Current position inside the file expressed as number of cipher blocks </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nonce_ctr</td><td>Initialization vector, see <a class="el" href="struct_s_e_f_i_l_e___h_e_a_d_e_r.html">SEFILE_HEADER</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nonce_pbkdf2</td><td>Initialization vector, see <a class="el" href="struct_s_e_f_i_l_e___h_e_a_d_e_r.html">SEFILE_HEADER</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="a533853754430e7d85524fd5641a7bf3b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_filename </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>file_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function extract the filename pointed by path. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>It can be both an absolute or relative path. No encrypted directory are allowed inside the path. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">file_name</td><td>A preallocated string where to store the filename. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a558cc4a9929c6dc846d54ec42012466c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t get_filesize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *&#160;</td>
          <td class="paramname"><em>hFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used to compute the total logic size of an open file handle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hFile</td><td>Open file handle whose size shall be computed. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">length</td><td>Pointer to a preallocated variable where to store the logic size. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="af387c94c97d3d3df73d0ddc6da891ad2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_path </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>full_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function extract the path where the file is. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">full_path</td><td>It can be both an absolute or relative path. No encrypted directory are allowed inside the path. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">path</td><td>A preallocated string where to store the path </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a54f66c38e6025c8e57ceda5c43d51c5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t secure_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *&#160;</td>
          <td class="paramname"><em>hFile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function releases resources related to hFile. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hFile</td><td>The handle to the file we do not want to manipulate no more. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="adbb72ef517bfb5e342fba86f2e72b25f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t secure_create </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *&#160;</td>
          <td class="paramname"><em>hFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function creates a new secure file and creates a SEFILE_FHANDLE that can be used in future. If the file already exists, it is overwritten with an empty one, all previous data are lost. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>Specify the absolute/relative path where to create the file. No encrypted directory are allowed inside the path. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hFile</td><td>The pointer in which the file handle to the new opened file is placed after a success, NULL in case of failure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mode</td><td>The mode in which the file should be created. See <a class="el" href="group___mode___defines.html">mode parameter for secure_open</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="a71736a6b4cc1a0ec94d013052e1e2a10"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t secure_finit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function deallocate the structures defined by the <a class="el" href="_s_efile_8c.html#a435a1cfd0cd619deb2efeb7aa3723126" title="This function creates a new secure environment, by allocating statically the parameters needed by the...">secure_init()</a>. Should be called at the end of a session. No parameters are needed;. </p>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="a987cae1899d44e2c86de985b6145d41b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t secure_getfilesize </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>position</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used to get the total logic size of an encrypted file pointed by path. Logic size will always be smaller than physical size. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>Absolute or relative path the file. No encrypted directory are allowed inside the path. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">position</td><td>Pointer to an allocated uint32_t variable where will be stored the file size. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="a435a1cfd0cd619deb2efeb7aa3723126"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t secure_init </td>
          <td>(</td>
          <td class="paramtype">se3_session *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>keyID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>crypto</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function creates a new secure environment, by allocating statically the parameters needed by the following functions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Contains the pointer to the se3_session structure that must be used during the session. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keyID</td><td>Contains the ID number of the key that must be used during the session. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">crypto</td><td>Contains the id to specify which algorithm to use. See AlgorithmAvail, it can be SE3_ALGO_MAX + 1 if you don't know which algorithm to choose. See <a class="el" href="group__error_values.html">error values</a> for error list.</td></tr>
  </table>
  </dd>
</dl>
<p>All the data passed to this function must be allocated and filled with valid data. Once secure_init succeed it is possible to destroy these data, since a copy has been made. N.B. Remember to call the <a class="el" href="_s_efile_8h.html#a71736a6b4cc1a0ec94d013052e1e2a10">secure_finit</a> function to deallocate these data once you have finished. </p>

</div>
</div>
<a class="anchor" id="a6b2a9a6b81381a4ce20421831103b8b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t secure_ls </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>list_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function identifies which encrypted files and encrypted directories are present in the directory pointed by path and writes them in list. It only recognizes the ones encrypted with the current environmental parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>Absolute or relative path to the directory to browse. No encrypted directory are allowed inside the path. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">list</td><td>Already allocated array where to store filenames and directory names. Each entry is separated by '\0'. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">list_length</td><td>Pointer to a uint32_t used to stored total number of characters written in list. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="afc10a53fb05941bb327447cbef30b963"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t secure_mkdir </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function creates a directory with an encrypted name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>Absolute or relative path of the new directory. No encrypted directory are allowed inside the path. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="ae99f8ccb396cbb5685d9e16bb3dbbe98"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t secure_open </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *&#160;</td>
          <td class="paramname"><em>hFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>access</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function opens a secure file and create a SEFILE_FHANDLE that can be used in future. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>Specify the absolute/relative path where to retrieve the file to open. No encrypted directory are allowed inside the path. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hFile</td><td>The pointer in which the file handle to the opened file is placed after a success, NULL in case of failure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mode</td><td>The mode in which the file should be opened. See <a class="el" href="group___mode___defines.html">mode parameter for secure_open</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">access</td><td>Define if the file should be created or it should already exist. See <a class="el" href="group___access___defines.html">access parameter for secure_open</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="ab4468e0e71fe2626767388150952fbdf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t secure_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *&#160;</td>
          <td class="paramname"><em>hFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>dataOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>dataOut_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>bytesRead</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function reads from hFile bytesRead characters out of dataOut_len correctly decrypted ones and stores them in dataOut string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hFile</td><td>The handle to an already opened file to be read. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dataOut</td><td>An already allocated array of characters where to store data read. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataOut_len</td><td>Number of characters we want to read. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bytesRead</td><td>Number of effective characters read, MUST NOT BE NULL. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="a157807247b4913a73fc3b6677a61e6a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t secure_seek </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *&#160;</td>
          <td class="paramname"><em>hFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>whence</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used to move correctly the file pointer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hFile</td><td>The handle to the file to manipulate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">offset</td><td>Amount of character we want to move. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">position</td><td>Pointer to a int32_t variable where the final position is stored, MUST NOT BE NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">whence</td><td>According to this parameter we can choose if we want to move from the file beginning, file ending or current file pointer position. See <a class="el" href="group___seek___defines.html">whence parameter for secure_seek</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="aae977955a0ae4b48158806cd45d2cd12"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t secure_sync </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *&#160;</td>
          <td class="paramname"><em>hFile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used in case we want to be sure that the physical file is synced with the OS buffers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hFile</td><td>Handle to the secure file to be synced. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="ae51272c2c3b72a01bd7aa98f25fb5245"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t secure_truncate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *&#160;</td>
          <td class="paramname"><em>hFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function resizes the file pointed by hFile to size. If size is bigger than its current size the gap is filled with 0s. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hFile</td><td>The handle to the file to manipulate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>New size of the file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="ae8d0daae652fc1f3e2c29781591aa36e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t secure_update </td>
          <td>(</td>
          <td class="paramtype">se3_session *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>keyID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>crypto</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function can be called only after the <a class="el" href="_s_efile_8c.html#a435a1cfd0cd619deb2efeb7aa3723126" title="This function creates a new secure environment, by allocating statically the parameters needed by the...">secure_init()</a> function and give to the user the possibility to overwrite the Environment variables with new ones. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Contains the pointer to the se3_session structure that must be used during the session. Can be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keyID</td><td>keyID Contains the ID number of the key that must be used during the session. Can be -1. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">crypto</td><td>Contains the id to specify which algorithm to use. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list.</dd></dl>
<p>Parameters from 1 to 3 can be a NULL pointer or '-1' value, if all parameters are NULL (or '-1' in case of keyID) the function is a No-Operation one. </p>

</div>
</div>
<a class="anchor" id="acb652f6362fd5635c4aaa8c5e67c7f1b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t secure_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_s_efile_8h.html#ac073933cdf58a366c2dfed344c37ebe9">SEFILE_FHANDLE</a> *&#160;</td>
          <td class="paramname"><em>hFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>dataIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>dataIn_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function writes the characters given by dataIn to the encrypted file hFile. Before writing them, dataIn is encrypted according to the environmental parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hFile</td><td>The handle to an already opened file to be written. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataIn</td><td>The string of characters that have to be written. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataIn_len</td><td>The length, in bytes, of the data that have to be written. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
<a class="anchor" id="a95ea3f63b783aca7223b6b885cab1a5e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t valid_name </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function checks if the given name can be a valid encrypted filename/directory name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Name</td><td>of the file/directory. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The function returns a (uint16_t) '0' in case of success. See <a class="el" href="group__error_values.html">error values</a> for error list. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Nov 9 2016 19:23:54 for SEFile by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
